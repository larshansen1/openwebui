# Base image: Open WebUI v0.7.2 (pinned version for stability)
FROM ghcr.io/open-webui/open-webui:v0.7.2

# Switch to root to install additional packages and set permissions
USER root

# Install additional Python packages
RUN pip install youtube-transcript-api

# Ensure data directories exist and have correct permissions
RUN mkdir -p /app/backend/data/uploads && \
    chown -R 1000:1000 /app/backend/data && \
    chown -R 1000:1000 /app/backend/open_webui/static

# Switch back to non-root user for security
USER 1000
